<!--
id:cpstun
category:Pitch Converters:Tuning Opcodes
-->
# cpstun
Returns micro-tuning values at k-rate.

## Syntax
``` csound-orc
kcps cpstun ktrig, kindex, kfn
```

### Performance

_kcps_ -- Return value in cycles per second.

_ktrig_ -- A trigger signal used to trigger the evaluation.

_kindex_ -- An integer number denoting an index of scale.

_kfn_ --  Function table containing the parameters (numgrades, interval, basefreq, basekeymidi) and the tuning ratios.

These opcodes are similar to [cpstmid](../../opcodes/cpstmid), but work without necessity of MIDI.

_cpstun_ works at k-rate. It allows fully customized micro-tuning scales. It requires a function table number containing the tuning ratios, and some other parameters stored in the function table itself.

_kindex_ arguments should be filled with integer numbers expressing the grade of given scale to be converted in cps. In _cpstun_, a new value is evaluated only when _ktrig_ contains a non-zero value.  The function table _kfn_ should be generated by [GEN02](../../scoregens/gen02) and the first four values stored in this function are parameters that express:

* numgrades -- The number of grades of the micro-tuning scale.
* interval -- The frequency range covered before repeating the grade ratios, for example 2 for one octave, 1.5 for a fifth etcetera.
* basefreq -- The base frequency of the scale in cycles per second.
* basekey -- The integer index of the scale to which to assign basefreq unmodified.

After these four values, the user can begin to insert the tuning ratios.  For example, for a standard 12-grade scale with the base-frequency of 261 cps assigned to the key-number 60, the corresponding f-statement in the score to generate the table should be:

``` csound-sco
;           numgrades    basefreq     tuning-ratios (eq.temp) .......
;                  interval    basekey
f1 0 64 -2  12     2     261   60     1   1.059463 1.12246 1.18920 ..etc...
```

Another example with a 24-grade scale with a base frequency of 440 assigned to the key-number 48, and a repetition interval of 1.5:

``` csound-sco
;                  numgrades       basefreq      tuning-ratios .......
;                          interval       basekey
f1 0 64 -2         24      1.5     440    48     1   1.01  1.02  1.03   ..etc...
```

## Examples

Here is an example of the cpstun opcode. It uses the file [cpstun.csd](../../examples/cpstun.csd).

``` csound-csd title="Example of the cpstun opcode." linenums="1"
--8<-- "examples/cpstun.csd"
```

Its output should include lines like this:

```
i1   440.11044
```

## See also

[Pitch Converters: Tuning Opcodes](../../pitch/tuning)

## Credits

Example written by Kevin Conder.
